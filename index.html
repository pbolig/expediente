<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Expedientes</title>
    <link rel="stylesheet" href="css/styles.css">
    <link rel="manifest" href="manifest.json">
</head>
<body>

    <header>
        <h1>Expedientes</h1>
    </header>

    <main>
        <section id="registro-expediente">
            <h2>Registrar Nuevo Expediente</h2>
            <form id="formulario-expediente">
                <label for="tipo-tramite">Tipo de Trámite:</label>
                <select id="tipo-tramite" required>
                    </select>

                <label for="descripcion">Descripción:</label>
                <textarea id="descripcion" rows="5" placeholder="Descripción detallada del trámite" required></textarea>

                <label>Documentación:</label>
                <div id="fotos-container">
                    <button type="button" id="btn-tomar-foto" class="btn btn-outline btn-block">Adjuntar Archivo</button>
                    <input type="file" id="input-foto" multiple style="display: none;">
                </div>

                <div id="fotos-previsualizacion">
                    </div>

                <button type="submit" id="btn-guardar" class="btn btn-primary btn-block">Guardar Expediente</button>
            </form>
        </section>

        <section id="panel-consulta">
            <h2>Panel de Consulta</h2>
            <form id="formulario-busqueda">
                <label for="campo-busqueda">Buscar:</label>
                <input type="text" id="campo-busqueda" placeholder="Nro. Expediente, descripción o tipo de trámite">
                <button type="submit" class="btn btn-primary">Buscar</button>
            </form>

            <div id="resultados-busqueda"></div>
            <div id="paginacion-busqueda" class="paginacion"></div>
        </section>

        <section id="panel-edicion" style="display: none;">
            
            <div class="panel-header">
                <h2>Detalles del Expediente</h2>
                <button id="btn-volver-busqueda" class="btn btn-secondary">← Volver</button>
            </div>

            <div id="info-expediente-general">
                </div>
            
            <h3>Historial de Acontecimientos</h3>
            <div id="grilla-acontecimientos">
                </div>

            <hr>

            <div class="accordion">
                    <h3 class="accordion-header">
                        Agregar Nuevo Acontecimiento
                        <span class="accordion-icon">+</span>
                    </h3>
                <div class="accordion-content">
                    <form id="formulario-edicion">
                        <input type="hidden" id="expediente-id-edicion">
                        
                        <label for="descripcion-edicion">Agregar descripción del acontecimiento:</label>
                        <textarea id="descripcion-edicion" rows="3" placeholder="Descripción de lo realizado" required></textarea>

                        <label>Documentación Adicional:</label>
                        <div id="fotos-container-edicion">
                            <button type="button" id="btn-adjuntar-edicion" class="btn btn-outline">Adjuntar Archivo</button>
                            <input type="file" id="input-foto-edicion" multiple style="display: none;">
                        </div>

                        <div id="fotos-previsualizacion-edicion"></div>
                        
                        <label for="estado-edicion">Cambiar Estado:</label>
                        <select id="estado-edicion">
                            <option value="en-espera">En Espera</option>
                            <option value="iniciado">Iniciado</option>
                            <option value="finalizado">Finalizado</option>
                        </select>

                        <button type="submit" class="btn btn-primary">Guardar Cambios</button>
                        <button type="button" id="btn-cancelar-edicion" class="btn btn-secondary">Cancelar</button>
                    </form>
                </div>
        </section>

    </main>

    <footer>
        <p>© 2025 Expedientes ISET57</p>
    </footer>

    <div id="modal-fotos" class="modal">
        <div class="modal-content">
            <span class="close-btn">&times;</span>
            <h2>Fotos / Archivos del Expediente</h2>
            <div id="fotos-modal-body">
                </div>
        </div>
    </div>

    <script src="js/app.js"></script>
    <script>
        // Registra el Service Worker
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/js/service-worker.js')
                    .then(reg => console.log('Service Worker registrado', reg))
                    .catch(err => console.error('Error al registrar el Service Worker', err));
            });
        }
    </script>
</body>
</html>